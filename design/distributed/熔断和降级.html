<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.9" />
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html,
      body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme')
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia('(prefers-color-scheme: dark)').matches
      if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
        document.documentElement.classList.toggle('dark', true)
      }
    </script>
    <title>熔断和降级 | 拔土豆的程序员</title><meta name="description" content="没进过大厂|技术一般|创业被坑|普普通通程序员">
    <link rel="preload" href="/assets/style-CrPIbz9v.css" as="style"><link rel="stylesheet" href="/assets/style-CrPIbz9v.css">
    <link rel="modulepreload" href="/assets/app-oJgUVX7T.js"><link rel="modulepreload" href="/assets/熔断和降级.html-iPb-0del.js">
    <link rel="prefetch" href="/assets/index.html-EBNsw65M.js" as="script"><link rel="prefetch" href="/assets/2024年05月08日.html-DpkD0kkX.js" as="script"><link rel="prefetch" href="/assets/2024年05月10日.html-C8KjusmD.js" as="script"><link rel="prefetch" href="/assets/2024年05月12日.html-DJS1tOkZ.js" as="script"><link rel="prefetch" href="/assets/HashMap扫盲.html-Du-RwmLU.js" as="script"><link rel="prefetch" href="/assets/index.html-xeunxkBw.js" as="script"><link rel="prefetch" href="/assets/index.html-C78CGH4a.js" as="script"><link rel="prefetch" href="/assets/index.html-CdFFWUAU.js" as="script"><link rel="prefetch" href="/assets/支付业务订单系统分库分表.html-yn0-uAik.js" as="script"><link rel="prefetch" href="/assets/第三方支付对接基础知识.html-BEO23y3e.js" as="script"><link rel="prefetch" href="/assets/高并发下防止重复下单.html-BEf21vEB.js" as="script"><link rel="prefetch" href="/assets/2023年10月25日阅读源码没有意义.html-C25sFIDd.js" as="script"><link rel="prefetch" href="/assets/index.html-BAxSgNbP.js" as="script"><link rel="prefetch" href="/assets/checkList.html-DGttBqdi.js" as="script"><link rel="prefetch" href="/assets/MyBatis动态SQL.html-DiN3E1Tl.js" as="script"><link rel="prefetch" href="/assets/MyBatis常用框架.html-DxnBTlwR.js" as="script"><link rel="prefetch" href="/assets/MyBatis批量插入.html-D8BhU80r.js" as="script"><link rel="prefetch" href="/assets/MyBatis自定义插件Interceptor.html-0qrxzRE6.js" as="script"><link rel="prefetch" href="/assets/MyBatis自定义类型处理器TypeHandler.html-ClT8SvI1.js" as="script"><link rel="prefetch" href="/assets/MybatisIDEA插件.html-DTydHtUZ.js" as="script"><link rel="prefetch" href="/assets/index.html-FxPIJN4z.js" as="script"><link rel="prefetch" href="/assets/MySQL-BinaryLog.html-C7hPGpYl.js" as="script"><link rel="prefetch" href="/assets/MySQL-FOR-UPDATE.html-Cn84jgao.js" as="script"><link rel="prefetch" href="/assets/MySQL-RedoLog.html-CRyUPhGY.js" as="script"><link rel="prefetch" href="/assets/MySQL-count用法分析.html-jqPLUQUD.js" as="script"><link rel="prefetch" href="/assets/MySQL-explain.html-_vyQNxl3.js" as="script"><link rel="prefetch" href="/assets/MySQL-limit优化.html-Be-JwQnc.js" as="script"><link rel="prefetch" href="/assets/MySQL-varchar与char.html-BO07AZQu.js" as="script"><link rel="prefetch" href="/assets/MySQL主键.html-DI5UTZjA.js" as="script"><link rel="prefetch" href="/assets/MySQL全文索引.html-x98Jqrph.js" as="script"><link rel="prefetch" href="/assets/MySQL分表分库-分库分表聚合查询.html-CmYlxBq8.js" as="script"><link rel="prefetch" href="/assets/MySQL分表分库.html-VLd4PPna.js" as="script"><link rel="prefetch" href="/assets/MySQL日志.html-BoFq2tti.js" as="script"><link rel="prefetch" href="/assets/MySQL更新优化.html-BJS_IeJY.js" as="script"><link rel="prefetch" href="/assets/MySQL索引优化.html-Dvaz-egv.js" as="script"><link rel="prefetch" href="/assets/index.html-eoiNdYLS.js" as="script"><link rel="prefetch" href="/assets/index.html-Rh3yZB2j.js" as="script"><link rel="prefetch" href="/assets/Redis 数据持久化.html-h-ka_yQz.js" as="script"><link rel="prefetch" href="/assets/Redisson看门狗.html-BAyAiJ42.js" as="script"><link rel="prefetch" href="/assets/Redis使用建议.html-CAqAp9ZJ.js" as="script"><link rel="prefetch" href="/assets/Redis应用场景.html-7szlND_r.js" as="script"><link rel="prefetch" href="/assets/Redis的BigKey和HotKey.html-DNvSqkVH.js" as="script"><link rel="prefetch" href="/assets/Redis简介.html-BghN0z5T.js" as="script"><link rel="prefetch" href="/assets/Redis线程模型.html-CBvfanNH.js" as="script"><link rel="prefetch" href="/assets/Redis过期策略.html-u2RKiv9C.js" as="script"><link rel="prefetch" href="/assets/Redis集群方式.html-CKDXn-cx.js" as="script"><link rel="prefetch" href="/assets/击穿穿透雪崩.html-CkFwKSfF.js" as="script"><link rel="prefetch" href="/assets/布隆过滤器.html-DgHtBGvz.js" as="script"><link rel="prefetch" href="/assets/常见缓存淘汰算法.html-k5_KgPVA.js" as="script"><link rel="prefetch" href="/assets/秒杀系统Redis常用脚本.html-EsKdYbLA.js" as="script"><link rel="prefetch" href="/assets/缓存和数据库的一致性问题.html-BOOP8n1J.js" as="script"><link rel="prefetch" href="/assets/index.html-i3In5LVe.js" as="script"><link rel="prefetch" href="/assets/OAuth2和单点登录.html-Bgx4JT2I.js" as="script"><link rel="prefetch" href="/assets/OAuth基本概念.html-IK37EYhC.js" as="script"><link rel="prefetch" href="/assets/OAuth常见问题.html-BTe5tU9d.js" as="script"><link rel="prefetch" href="/assets/index.html-CE0DmgI_.js" as="script"><link rel="prefetch" href="/assets/index.html-DcNJXLLp.js" as="script"><link rel="prefetch" href="/assets/SaaS多租户数据隔离.html-B7KBGO9I.js" as="script"><link rel="prefetch" href="/assets/二级评论设计.html-DoE3i9S-.js" as="script"><link rel="prefetch" href="/assets/技术设计模板.html-6qZYA1W0.js" as="script"><link rel="prefetch" href="/assets/权限系统设计.html-DepJ7Sjv.js" as="script"><link rel="prefetch" href="/assets/秒杀活动设计.html-BjOegVO1.js" as="script"><link rel="prefetch" href="/assets/index.html-gPcwQm0-.js" as="script"><link rel="prefetch" href="/assets/VODTODOPO.html-DSK2rs-r.js" as="script"><link rel="prefetch" href="/assets/controller规范.html-CHs7VE2C.js" as="script"><link rel="prefetch" href="/assets/一种代码命名规范.html-Bh7IlwkC.js" as="script"><link rel="prefetch" href="/assets/一种分包思路.html-DXeii9_4.js" as="script"><link rel="prefetch" href="/assets/乐观锁和悲观锁.html-DCG7IG9S.js" as="script"><link rel="prefetch" href="/assets/版本号命名规则.html-BJo1mzz2.js" as="script"><link rel="prefetch" href="/assets/index.html-CGohko3L.js" as="script"><link rel="prefetch" href="/assets/index.html-x0L98WQe.js" as="script"><link rel="prefetch" href="/assets/Redis分布式锁.html-iDnwtrAE.js" as="script"><link rel="prefetch" href="/assets/Redis官方文档.html-CECqSFEW.js" as="script"><link rel="prefetch" href="/assets/zookeeper分布式锁.html-D49cvupZ.js" as="script"><link rel="prefetch" href="/assets/全局唯一ID实现方案.html-CsuRKZwu.js" as="script"><link rel="prefetch" href="/assets/分布式事务两阶段提交和三阶段提交.html-CdC-_lyG.js" as="script"><link rel="prefetch" href="/assets/分布式服务链路追踪.html-CP-avjye.js" as="script"><link rel="prefetch" href="/assets/分布式锁.html-vIRYScnJ.js" as="script"><link rel="prefetch" href="/assets/分布式锁及实现方案.html-B_yGHHlu.js" as="script"><link rel="prefetch" href="/assets/分库分表常见算法.html-3Wbz3zaf.js" as="script"><link rel="prefetch" href="/assets/分库分表策略以及平滑扩容.html-C3QFC12P.js" as="script"><link rel="prefetch" href="/assets/并发系统设计.html-B9Rx_2kR.js" as="script"><link rel="prefetch" href="/assets/微服务中台等等设计.html-D_XJZh7S.js" as="script"><link rel="prefetch" href="/assets/高并发性能指标.html-C7YVpMvU.js" as="script"><link rel="prefetch" href="/assets/HashCode.html-7RXCJnvr.js" as="script"><link rel="prefetch" href="/assets/HashMap加载因子.html-Af74MdWm.js" as="script"><link rel="prefetch" href="/assets/HashMap的hash值计算.html-C0xq2DWL.js" as="script"><link rel="prefetch" href="/assets/HashMap的初始容量.html-BnoL6qgR.js" as="script"><link rel="prefetch" href="/assets/HashMap的扩容.html-9v6dgyyZ.js" as="script"><link rel="prefetch" href="/assets/Java集合.html-CTiFKGIq.js" as="script"><link rel="prefetch" href="/assets/Java集合ArrayList.html-tbRfb2-E.js" as="script"><link rel="prefetch" href="/assets/index.html-CawiM6qn.js" as="script"><link rel="prefetch" href="/assets/SPI机制.html-CTLIBDrR.js" as="script"><link rel="prefetch" href="/assets/值传递.html-CZCLlw7u.js" as="script"><link rel="prefetch" href="/assets/基本数据类型和引用数据类型.html-C7TL7DfI.js" as="script"><link rel="prefetch" href="/assets/线程池.html-DZkl2GIK.js" as="script"><link rel="prefetch" href="/assets/面向对象.html-DLbuWS3F.js" as="script"><link rel="prefetch" href="/assets/AQS.html-zAWEWsa8.js" as="script"><link rel="prefetch" href="/assets/CompletableFuture.html-BIi4-4q3.js" as="script"><link rel="prefetch" href="/assets/ConcurrentHashMap.html-DqfXvErD.js" as="script"><link rel="prefetch" href="/assets/Java并发基础.html-NbKqJwEQ.js" as="script"><link rel="prefetch" href="/assets/index.html-0ttx0tan.js" as="script"><link rel="prefetch" href="/assets/ReetrantLock.html-Cnda8cSM.js" as="script"><link rel="prefetch" href="/assets/四种线程池.html-CDuYvLwX.js" as="script"><link rel="prefetch" href="/assets/无锁CAS机制.html-BG77zLwY.js" as="script"><link rel="prefetch" href="/assets/线程池.html-CxLNZxyM.js" as="script"><link rel="prefetch" href="/assets/GC调优.html-CoJNvnLY.js" as="script"><link rel="prefetch" href="/assets/Java内存布局.html-9dPs3vx-.js" as="script"><link rel="prefetch" href="/assets/Java垃圾回收基础.html-DgBNDqKk.js" as="script"><link rel="prefetch" href="/assets/OOM.html-CdKiFKbM.js" as="script"><link rel="prefetch" href="/assets/index.html-Vm-0tn7N.js" as="script"><link rel="prefetch" href="/assets/ApacheCommon.html-BtEpf4Pm.js" as="script"><link rel="prefetch" href="/assets/GoogleGuava.html-CgidmNLu.js" as="script"><link rel="prefetch" href="/assets/Hutool.html-D_6W_Xhn.js" as="script"><link rel="prefetch" href="/assets/JSON.html-h-LispoD.js" as="script"><link rel="prefetch" href="/assets/Lombok.html-DM-Umpps.js" as="script"><link rel="prefetch" href="/assets/MapStruct.html-BJBzvSgI.js" as="script"><link rel="prefetch" href="/assets/MapStruct和lombok.html-2kHr4A4t.js" as="script"><link rel="prefetch" href="/assets/index.html-B3FKsWeS.js" as="script"><link rel="prefetch" href="/assets/Spring常用工具类.html-KOlFnUTh.js" as="script"><link rel="prefetch" href="/assets/log.html-CGdQ6WpX.js" as="script"><link rel="prefetch" href="/assets/other.html-BQpgfNGe.js" as="script"><link rel="prefetch" href="/assets/index.html-aecQkp2-.js" as="script"><link rel="prefetch" href="/assets/RabbitMQ.html-xNs4OoPM.js" as="script"><link rel="prefetch" href="/assets/RabbitMQ消息丢失消息重复消息积压.html-wXWBdedM.js" as="script"><link rel="prefetch" href="/assets/RabbitProperties.html-DpB3Jrj_.js" as="script"><link rel="prefetch" href="/assets/BeanUtils.html-Co6KOQa_.js" as="script"><link rel="prefetch" href="/assets/index.html-Bu3z5T52.js" as="script"><link rel="prefetch" href="/assets/SpringBean生命周期.html-D1BBdKh6.js" as="script"><link rel="prefetch" href="/assets/SpringModulith简介.html-Dq6kV4zx.js" as="script"><link rel="prefetch" href="/assets/Spring中事务以及事务的传播机制.html-W88aQ3FD.js" as="script"><link rel="prefetch" href="/assets/Spring事件.html-CJyqqHzF.js" as="script"><link rel="prefetch" href="/assets/Spring事件和事务的关系.html-Bk9rMbbc.js" as="script"><link rel="prefetch" href="/assets/Spring核心之面向切面编程(AOP).html-CCq4TvCu.js" as="script"><link rel="prefetch" href="/assets/OAuth2Client对接认证服务.html-C2Aenlzf.js" as="script"><link rel="prefetch" href="/assets/index.html-BsWI-utS.js" as="script"><link rel="prefetch" href="/assets/SpringAuthorizationServer-02.html-CzSZTsCy.js" as="script"><link rel="prefetch" href="/assets/SpringAuthorizationServer-03.html-x1FPMB2J.js" as="script"><link rel="prefetch" href="/assets/基本概念.html-Ck9SBMGd.js" as="script"><link rel="prefetch" href="/assets/客户端认证授权.html-DfiIeu1e.js" as="script"><link rel="prefetch" href="/assets/常用端点.html-C3vZvqk5.js" as="script"><link rel="prefetch" href="/assets/资源服务器.html-CEAra9ZZ.js" as="script"><link rel="prefetch" href="/assets/index.html-AlC-uJ1I.js" as="script"><link rel="prefetch" href="/assets/Resilience4j.html-elPgkGlQ.js" as="script"><link rel="prefetch" href="/assets/Resilience4j整合案例.html-CJcSC-6D.js" as="script"><link rel="prefetch" href="/assets/SpringCloudLoadBalancer负载均衡策略与缓存机制.html-BaDmXBK4.js" as="script"><link rel="prefetch" href="/assets/Docker基础.html-C_u-xfqP.js" as="script"><link rel="prefetch" href="/assets/index.html-DYyKA_Cl.js" as="script"><link rel="prefetch" href="/assets/Arthas基本使用.html-Cb6zuKnq.js" as="script"><link rel="prefetch" href="/assets/index.html-B16YBg48.js" as="script"><link rel="prefetch" href="/assets/Git分支规范.html-BUQkbD3d.js" as="script"><link rel="prefetch" href="/assets/Git基本操作.html-BYIdyaC0.js" as="script"><link rel="prefetch" href="/assets/Git基础.html-BM67ZS8y.js" as="script"><link rel="prefetch" href="/assets/Git提交message规范.html-BIUCgkte.js" as="script"><link rel="prefetch" href="/assets/index.html-UWYFoOSQ.js" as="script"><link rel="prefetch" href="/assets/从0到1分支操作.html-B5rFpth5.js" as="script"><link rel="prefetch" href="/assets/index.html-_GgIK-i8.js" as="script"><link rel="prefetch" href="/assets/AI代码插件.html-DPxl65jT.js" as="script"><link rel="prefetch" href="/assets/index.html-D24phK_D.js" as="script"><link rel="prefetch" href="/assets/常见问题.html-D4aif3NW.js" as="script"><link rel="prefetch" href="/assets/index.html-C40cx5gN.js" as="script"><link rel="prefetch" href="/assets/Maven基础.html-BfAU4nzh.js" as="script"><link rel="prefetch" href="/assets/Maven常见问题.html-TmLwMQzE.js" as="script"><link rel="prefetch" href="/assets/index.html-CXagl7V7.js" as="script"><link rel="prefetch" href="/assets/服务器手动部署Maven项目.html-BMHXbxdK.js" as="script"><link rel="prefetch" href="/assets/404.html-C_KSZqCQ.js" as="script"><link rel="prefetch" href="/assets/style-l0sNRNKZ.js" as="script"><link rel="prefetch" href="/assets/docsearch-l0sNRNKZ.js" as="script"><link rel="prefetch" href="/assets/index-zMbLkDvU.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a class="route-link" href="/"><img class="logo" src="/images/logo.png" alt="拔土豆的程序员"><span class="site-name can-hide" aria-hidden="true">拔土豆的程序员</span></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><nav class="navbar-items can-hide" aria-label="site navigation"><!--[--><div class="navbar-item"><a class="route-link" href="/" aria-label="首页"><!--[--><!--[--><!--]--> 首页 <!--[--><!--]--><!--]--></a></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="java"><span class="title">java</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="java"><span class="title">java</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a class="route-link" href="/java/base/" aria-label="Java基础"><!--[--><!--[--><!--]--> Java基础 <!--[--><!--]--><!--]--></a></li><li class="navbar-dropdown-item"><a class="route-link" href="/java/concurrent/" aria-label="Java并发编程"><!--[--><!--[--><!--]--> Java并发编程 <!--[--><!--]--><!--]--></a></li><li class="navbar-dropdown-item"><a class="route-link" href="/java/jvm/" aria-label="JVM"><!--[--><!--[--><!--]--> JVM <!--[--><!--]--><!--]--></a></li><li class="navbar-dropdown-item"><a class="route-link" href="/java/opensource/" aria-label="开源框架"><!--[--><!--[--><!--]--> 开源框架 <!--[--><!--]--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="消息队列"><span class="title">消息队列</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="消息队列"><span class="title">消息队列</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a class="route-link" href="/mq/rabbitmq/" aria-label="RabbitMQ"><!--[--><!--[--><!--]--> RabbitMQ <!--[--><!--]--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="架构"><span class="title">架构</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="架构"><span class="title">架构</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a class="route-link" href="/design/OAuth/" aria-label="OAuth"><!--[--><!--[--><!--]--> OAuth <!--[--><!--]--><!--]--></a></li><li class="navbar-dropdown-item"><a class="route-link route-link-active" href="/design/distributed/" aria-label="分布式系统设计"><!--[--><!--[--><!--]--> 分布式系统设计 <!--[--><!--]--><!--]--></a></li><li class="navbar-dropdown-item"><a class="route-link" href="/design/designpatterns/" aria-label="设计模式"><!--[--><!--[--><!--]--> 设计模式 <!--[--><!--]--><!--]--></a></li><li class="navbar-dropdown-item"><a class="route-link" href="/design/codedesign/" aria-label="代码设计"><!--[--><!--[--><!--]--> 代码设计 <!--[--><!--]--><!--]--></a></li><li class="navbar-dropdown-item"><a class="route-link" href="/design/business/" aria-label="业务功能设计"><!--[--><!--[--><!--]--> 业务功能设计 <!--[--><!--]--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="数据库|ORM框架"><span class="title">数据库|ORM框架</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="数据库|ORM框架"><span class="title">数据库|ORM框架</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a class="route-link" href="/database/mybatis/" aria-label="Mybatis"><!--[--><!--[--><!--]--> Mybatis <!--[--><!--]--><!--]--></a></li><li class="navbar-dropdown-item"><a class="route-link" href="/database/mysql/" aria-label="MySQL"><!--[--><!--[--><!--]--> MySQL <!--[--><!--]--><!--]--></a></li><li class="navbar-dropdown-item"><a class="route-link" href="/database/nosql/" aria-label="NoSQL"><!--[--><!--[--><!--]--> NoSQL <!--[--><!--]--><!--]--></a></li><li class="navbar-dropdown-item"><a class="route-link" href="/database/postgresql/" aria-label="PostgreSQL"><!--[--><!--[--><!--]--> PostgreSQL <!--[--><!--]--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Spring"><span class="title">Spring</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Spring"><span class="title">Spring</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a class="route-link" href="/spring/spring/" aria-label="Spring"><!--[--><!--[--><!--]--> Spring <!--[--><!--]--><!--]--></a></li><li class="navbar-dropdown-item"><a class="route-link" href="/spring/springBoot/" aria-label="SpringBoot"><!--[--><!--[--><!--]--> SpringBoot <!--[--><!--]--><!--]--></a></li><li class="navbar-dropdown-item"><a class="route-link" href="/spring/springCloud/" aria-label="SpringCloud"><!--[--><!--[--><!--]--> SpringCloud <!--[--><!--]--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><a class="route-link" href="/pay/" aria-label="支付系统"><!--[--><!--[--><!--]--> 支付系统 <!--[--><!--]--><!--]--></a></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="工具集"><span class="title">工具集</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="工具集"><span class="title">工具集</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a class="route-link" href="/tools/Docker/" aria-label="Docker"><!--[--><!--[--><!--]--> Docker <!--[--><!--]--><!--]--></a></li><li class="navbar-dropdown-item"><a class="route-link" href="/tools/arthas/" aria-label="Arthas"><!--[--><!--[--><!--]--> Arthas <!--[--><!--]--><!--]--></a></li><li class="navbar-dropdown-item"><a class="route-link" href="/tools/mac/" aria-label="Mac软件"><!--[--><!--[--><!--]--> Mac软件 <!--[--><!--]--><!--]--></a></li><li class="navbar-dropdown-item"><a class="route-link" href="/tools/maven/" aria-label="Maven"><!--[--><!--[--><!--]--> Maven <!--[--><!--]--><!--]--></a></li><li class="navbar-dropdown-item"><a class="route-link" href="/tools/git/" aria-label="Git"><!--[--><!--[--><!--]--> Git <!--[--><!--]--><!--]--></a></li><li class="navbar-dropdown-item"><a class="route-link" href="/tools/idea/" aria-label="IntelliJ IDEA"><!--[--><!--[--><!--]--> IntelliJ IDEA <!--[--><!--]--><!--]--></a></li><li class="navbar-dropdown-item"><a class="route-link" href="/tools/help/" aria-label="效率工具"><!--[--><!--[--><!--]--> 效率工具 <!--[--><!--]--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><a class="external-link" href="https://github.com/lizhifuabc" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--[--><!--]--> GitHub <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button class="toggle-color-mode-button" title="toggle color mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><!--[--><div id="docsearch-container" style="display:none;"></div><div><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"><svg width="15" height="15" class="DocSearch-Control-Key-Icon"><path d="M4.505 4.496h2M5.505 5.496v5M8.216 4.496l.055 5.993M10 7.5c.333.333.5.667.5 1v2M12.326 4.5v5.996M8.384 4.496c1.674 0 2.116 0 2.116 1.5s-.442 1.5-2.116 1.5M3.205 9.303c-.09.448-.277 1.21-1.241 1.203C1 10.5.5 9.513.5 8V7c0-1.57.5-2.5 1.464-2.494.964.006 1.134.598 1.24 1.342M12.553 10.5h1.953" stroke-width="1.2" stroke="currentColor" fill="none" stroke-linecap="square"></path></svg></kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div><!--]--></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-items" aria-label="site navigation"><!--[--><div class="navbar-item"><a class="route-link" href="/" aria-label="首页"><!--[--><!--[--><!--]--> 首页 <!--[--><!--]--><!--]--></a></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="java"><span class="title">java</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="java"><span class="title">java</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a class="route-link" href="/java/base/" aria-label="Java基础"><!--[--><!--[--><!--]--> Java基础 <!--[--><!--]--><!--]--></a></li><li class="navbar-dropdown-item"><a class="route-link" href="/java/concurrent/" aria-label="Java并发编程"><!--[--><!--[--><!--]--> Java并发编程 <!--[--><!--]--><!--]--></a></li><li class="navbar-dropdown-item"><a class="route-link" href="/java/jvm/" aria-label="JVM"><!--[--><!--[--><!--]--> JVM <!--[--><!--]--><!--]--></a></li><li class="navbar-dropdown-item"><a class="route-link" href="/java/opensource/" aria-label="开源框架"><!--[--><!--[--><!--]--> 开源框架 <!--[--><!--]--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="消息队列"><span class="title">消息队列</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="消息队列"><span class="title">消息队列</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a class="route-link" href="/mq/rabbitmq/" aria-label="RabbitMQ"><!--[--><!--[--><!--]--> RabbitMQ <!--[--><!--]--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="架构"><span class="title">架构</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="架构"><span class="title">架构</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a class="route-link" href="/design/OAuth/" aria-label="OAuth"><!--[--><!--[--><!--]--> OAuth <!--[--><!--]--><!--]--></a></li><li class="navbar-dropdown-item"><a class="route-link route-link-active" href="/design/distributed/" aria-label="分布式系统设计"><!--[--><!--[--><!--]--> 分布式系统设计 <!--[--><!--]--><!--]--></a></li><li class="navbar-dropdown-item"><a class="route-link" href="/design/designpatterns/" aria-label="设计模式"><!--[--><!--[--><!--]--> 设计模式 <!--[--><!--]--><!--]--></a></li><li class="navbar-dropdown-item"><a class="route-link" href="/design/codedesign/" aria-label="代码设计"><!--[--><!--[--><!--]--> 代码设计 <!--[--><!--]--><!--]--></a></li><li class="navbar-dropdown-item"><a class="route-link" href="/design/business/" aria-label="业务功能设计"><!--[--><!--[--><!--]--> 业务功能设计 <!--[--><!--]--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="数据库|ORM框架"><span class="title">数据库|ORM框架</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="数据库|ORM框架"><span class="title">数据库|ORM框架</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a class="route-link" href="/database/mybatis/" aria-label="Mybatis"><!--[--><!--[--><!--]--> Mybatis <!--[--><!--]--><!--]--></a></li><li class="navbar-dropdown-item"><a class="route-link" href="/database/mysql/" aria-label="MySQL"><!--[--><!--[--><!--]--> MySQL <!--[--><!--]--><!--]--></a></li><li class="navbar-dropdown-item"><a class="route-link" href="/database/nosql/" aria-label="NoSQL"><!--[--><!--[--><!--]--> NoSQL <!--[--><!--]--><!--]--></a></li><li class="navbar-dropdown-item"><a class="route-link" href="/database/postgresql/" aria-label="PostgreSQL"><!--[--><!--[--><!--]--> PostgreSQL <!--[--><!--]--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Spring"><span class="title">Spring</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Spring"><span class="title">Spring</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a class="route-link" href="/spring/spring/" aria-label="Spring"><!--[--><!--[--><!--]--> Spring <!--[--><!--]--><!--]--></a></li><li class="navbar-dropdown-item"><a class="route-link" href="/spring/springBoot/" aria-label="SpringBoot"><!--[--><!--[--><!--]--> SpringBoot <!--[--><!--]--><!--]--></a></li><li class="navbar-dropdown-item"><a class="route-link" href="/spring/springCloud/" aria-label="SpringCloud"><!--[--><!--[--><!--]--> SpringCloud <!--[--><!--]--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><a class="route-link" href="/pay/" aria-label="支付系统"><!--[--><!--[--><!--]--> 支付系统 <!--[--><!--]--><!--]--></a></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="工具集"><span class="title">工具集</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="工具集"><span class="title">工具集</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a class="route-link" href="/tools/Docker/" aria-label="Docker"><!--[--><!--[--><!--]--> Docker <!--[--><!--]--><!--]--></a></li><li class="navbar-dropdown-item"><a class="route-link" href="/tools/arthas/" aria-label="Arthas"><!--[--><!--[--><!--]--> Arthas <!--[--><!--]--><!--]--></a></li><li class="navbar-dropdown-item"><a class="route-link" href="/tools/mac/" aria-label="Mac软件"><!--[--><!--[--><!--]--> Mac软件 <!--[--><!--]--><!--]--></a></li><li class="navbar-dropdown-item"><a class="route-link" href="/tools/maven/" aria-label="Maven"><!--[--><!--[--><!--]--> Maven <!--[--><!--]--><!--]--></a></li><li class="navbar-dropdown-item"><a class="route-link" href="/tools/git/" aria-label="Git"><!--[--><!--[--><!--]--> Git <!--[--><!--]--><!--]--></a></li><li class="navbar-dropdown-item"><a class="route-link" href="/tools/idea/" aria-label="IntelliJ IDEA"><!--[--><!--[--><!--]--> IntelliJ IDEA <!--[--><!--]--><!--]--></a></li><li class="navbar-dropdown-item"><a class="route-link" href="/tools/help/" aria-label="效率工具"><!--[--><!--[--><!--]--> 效率工具 <!--[--><!--]--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><a class="external-link" href="https://github.com/lizhifuabc" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--[--><!--]--> GitHub <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-items"><!--[--><li><p tabindex="0" class="sidebar-item sidebar-heading">熔断和降级 <!----></p><ul style="" class="sidebar-item-children"><!--[--><li><a class="route-link sidebar-item" href="#雪崩效应" aria-label="雪崩效应"><!--[--><!--[--><!--]--> 雪崩效应 <!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="#常见容错模式" aria-label="常见容错模式"><!--[--><!--[--><!--]--> 常见容错模式 <!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="#服务降级" aria-label="服务降级"><!--[--><!--[--><!--]--> 服务降级 <!--[--><!--]--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a class="route-link sidebar-item" href="#降级方式" aria-label="降级方式"><!--[--><!--[--><!--]--> 降级方式 <!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="#降级预案" aria-label="降级预案"><!--[--><!--[--><!--]--> 降级预案 <!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="#服务降级分类" aria-label="服务降级分类"><!--[--><!--[--><!--]--> 服务降级分类 <!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="#自动降级分类" aria-label="自动降级分类"><!--[--><!--[--><!--]--> 自动降级分类 <!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="#问题" aria-label="问题"><!--[--><!--[--><!--]--> 问题 <!--[--><!--]--><!--]--></a><!----></li><!--]--></ul></li><li><a class="route-link sidebar-item" href="#服务熔断" aria-label="服务熔断"><!--[--><!--[--><!--]--> 服务熔断 <!--[--><!--]--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a class="route-link sidebar-item" href="#熔断的意义" aria-label="熔断的意义"><!--[--><!--[--><!--]--> 熔断的意义 <!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="#熔断适用场景" aria-label="熔断适用场景"><!--[--><!--[--><!--]--> 熔断适用场景 <!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="#断路器" aria-label="断路器"><!--[--><!--[--><!--]--> 断路器 <!--[--><!--]--><!--]--></a><!----></li><!--]--></ul></li><li><a class="route-link sidebar-item" href="#开源方案" aria-label="开源方案"><!--[--><!--[--><!--]--> 开源方案 <!--[--><!--]--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><!--]--><div><h1 id="熔断和降级" tabindex="-1"><a class="header-anchor" href="#熔断和降级"><span>熔断和降级</span></a></h1><p>在高并发环境下，服务之间的依赖关系导致调用失败，解决的方式通常是: 限流-&gt;熔断-&gt;隔离-&gt;降级, 其目的是防止雪崩效应。</p><h2 id="雪崩效应" tabindex="-1"><a class="header-anchor" href="#雪崩效应"><span>雪崩效应</span></a></h2><p><img src="/assets/image-20230915115541458-BvzdNaeW.png" alt="image-20230915115541458"></p><ol><li>服务 D 出现 CPU、内存占用过高等问题，结果导致服务 D 出现延迟、响应过慢</li><li>此时服务 B 一直等待 D 的响应，也会出现请求堆积、资源占用</li><li>慢慢扩散到所有微服务，引发雪崩效应</li></ol><h2 id="常见容错模式" tabindex="-1"><a class="header-anchor" href="#常见容错模式"><span>常见容错模式</span></a></h2><ol><li><p>超时：请求主动设置一个超时时间，超时就直接返回，不会造成服务堆积</p></li><li><p>限流：限制最大并发数</p></li><li><p>熔断：当错误数超过阈值时快速失败，不调用后端服务，同时隔一定时间放几个请求去重试后端服务是否能正常调用，如果成功则关闭熔断状态，失败则继续快速失败，直接返回。（此处有个重试，重试就是弹性恢复的能力）</p></li><li><p>隔离：把每个依赖或调用的服务都隔离开来，防止级联失败引起整体服务不可用</p></li><li><p>降级：服务失败或异常后，返回指定的默认信息</p></li></ol><h2 id="服务降级" tabindex="-1"><a class="header-anchor" href="#服务降级"><span>服务降级</span></a></h2><p>由于爆炸性的流量冲击，对一些服务进行有策略的放弃，以此缓解系统压力，保证目前主要业务的正常运行。它主要是针对非正常情况下的应急服务措施：当此时一些业务服务无法执行时，给出一个统一的返回结果。</p><ul><li>前提：负荷超出整体负载承受能力。</li><li>目的：保证重要或基本服务正常运行，非重要服务延迟使用或暂停使用</li><li>大小：降低服务粒度，要考虑整体模块粒度的大小，将粒度控制在合适的范围内</li><li>可控性：在服务粒度大小的基础上增加服务的可控性，后台服务开关的功能是一项必要配置（单机可配置文件，其他可使用数据库和缓存），可分为手动控制和自动控制。</li><li>次序：一般从外围延伸服务开始降级，需要有一定的配置项，重要性低的优先降级，比如可以分组设置等级1-10，当服务需要降级到某一个级别时，进行相关配置</li></ul><h3 id="降级方式" tabindex="-1"><a class="header-anchor" href="#降级方式"><span>降级方式</span></a></h3><ul><li>延迟服务：比如发表了评论，重要服务，比如在文章中显示正常，但是延迟给用户增加积分，只是放到一个缓存中，等服务平稳之后再执行。</li><li>在粒度范围内关闭服务（片段降级或服务功能降级）：比如关闭相关文章的推荐，直接关闭推荐区</li><li>页面异步请求降级：比如商品详情页上有推荐信息/配送至等异步加载的请求，如果这些信息响应慢或者后端服务有问题，可以进行降级；</li><li>页面跳转（页面降级）：比如可以有相关文章推荐，但是更多的页面则直接跳转到某一个地址</li><li>写降级：比如秒杀抢购，我们可以只进行Cache的更新，然后异步同步扣减库存到DB，保证最终一致性即可，此时可以将DB降级为Cache。</li><li>读降级：比如多级缓存模式，如果后端服务有问题，可以降级为只读缓存，这种方式适用于对读一致性要求不高的场景。</li></ul><h3 id="降级预案" tabindex="-1"><a class="header-anchor" href="#降级预案"><span>降级预案</span></a></h3><p>在进行降级之前要对系统进行梳理，看看系统是不是可以丢卒保帅；从而梳理出哪些必须誓死保护，哪些可降级；比如可以参考日志级别设置预案：</p><ul><li><p>一般：比如有些服务偶尔因为网络抖动或者服务正在上线而超时，可以自动降级；</p></li><li><p>警告：有些服务在一段时间内成功率有波动（如在95~100%之间），可以自动降级或人工降级，并发送告警；</p></li><li><p>错误：比如可用率低于90%，或者数据库连接池被打爆了，或者访问量突然猛增到系统能承受的最大阀值，此时可以根据情况自动降级或者人工降级；</p></li><li><p>严重错误：比如因为特殊原因数据错误了，此时需要紧急人工降级。</p></li></ul><h3 id="服务降级分类" tabindex="-1"><a class="header-anchor" href="#服务降级分类"><span>服务降级分类</span></a></h3><ul><li>降级按照是否自动化可分为：自动开关降级（超时、失败次数、故障、限流）和人工开关降级（秒杀、电商大促等）。</li><li>降级按照功能可分为：读服务降级、写服务降级。</li><li>降级按照处于的系统层次可分为：多级降级。</li></ul><h3 id="自动降级分类" tabindex="-1"><a class="header-anchor" href="#自动降级分类"><span>自动降级分类</span></a></h3><ul><li><p>超时降级：主要配置好超时时间和超时重试次数和机制，并使用异步机制探测回复情况</p></li><li><p>失败次数降级：主要是一些不稳定的api，当失败调用次数达到一定阀值自动降级，同样要使用异步机制探测回复情况</p></li><li><p>故障降级：比如要调用的远程服务挂掉了（网络故障、DNS故障、http服务返回错误的状态码、rpc服务抛出异常），则可以直接降级。降级后的处理方案有：默认值（比如库存服务挂了，返回默认现货）、兜底数据（比如广告挂了，返回提前准备好的一些静态页面）、缓存（之前暂存的一些缓存数据）</p></li><li><p>限流降级: 当我们去秒杀或者抢购一些限购商品时，此时可能会因为访问量太大而导致系统崩溃，此时开发者会使用限流来进行限制访问量，当达到限流阀值，后续请求会被降级；降级后的处理方案可以是：排队页面（将用户导流到排队页面等一会重试）、无货（直接告知用户没货了）、错误页（如活动太火爆了，稍后重试）</p></li></ul><h3 id="问题" tabindex="-1"><a class="header-anchor" href="#问题"><span>问题</span></a></h3><ul><li>核心服务或非核心服务。</li><li>是否支持降级，及其降级策略。</li><li>业务放通场景，极其策略。</li></ul><h2 id="服务熔断" tabindex="-1"><a class="header-anchor" href="#服务熔断"><span>服务熔断</span></a></h2><p>熔断这一概念来源于电子工程中的断路器（Circuit Breaker）。在互联网系统中，当下游服务因访问压力过大而响应变慢或失败，上游服务为了保护系统整体的可用性，可以暂时切断对下游服务的调用。</p><p>熔断机制是应对雪崩效应的一种微服务链路保护机制，当整个链路的某个微服务不可用或者响应时间太长时，会进行服务的降级，进而熔断该节点微服务的调用，快速返回”错误”的响应信息。</p><h3 id="熔断的意义" tabindex="-1"><a class="header-anchor" href="#熔断的意义"><span>熔断的意义</span></a></h3><p><strong>上游服务快速失败（Fail Fast），保护下游服务</strong>。</p><h3 id="熔断适用场景" tabindex="-1"><a class="header-anchor" href="#熔断适用场景"><span>熔断适用场景</span></a></h3><p>出于系统性能问题的考虑，并发不高时timeout可以避免线程阻塞带来的性能问题，但是并发高时timeout就不能解决问题啦。这时可以用熔断。</p><p>只要是服务之间的调用，并且能设计合理的获取返回值的方案（返回值可以是默认值，或者通过一种后备（Fallback）方案获取的值），一般业务场景都可以做熔断处理。</p><p>比如电商行业，在sku不是很多的场景下，我们可以在订单服务冗余库存数据（注意控制合理的安全库存，防超卖）。下单减库存时，如果库存服务挂了，开启熔断后，我们可以直接从订单服务取库存，订单服务取不到库存，按扣减库存失败处理。这个可以做为后备（Fallback）方案。</p><h3 id="断路器" tabindex="-1"><a class="header-anchor" href="#断路器"><span>断路器</span></a></h3><p>“断路器”本身是一种开关装置，当某个服务单元发生故障监控(类似熔断保险丝)，向调用方法返回一个符合预期的、可处理的备选响应(FallBack)，而不是长时间的等待或者抛出调用方法无法处理的异常，这样就保证了服务调用方的线程不会被长时间、不必要地占用，从而避免了故障在分布式系统中的蔓延。乃至雪崩。</p><h2 id="开源方案" tabindex="-1"><a class="header-anchor" href="#开源方案"><span>开源方案</span></a></h2><ol><li><p>Sentinel：</p><p>阿里中间件团队开源的，面向分布式服务架构的轻量级高可用流量控制组件，主要以流量为切入点，从流量控制、熔断降级、系统负载保护等多个维度来帮助用户保护服务的稳定性。</p></li><li><p>Hystrix：</p><p>Hystrix是一个用于分布式系统的延迟和容错的开源库。在分布式系统里，许多依赖不可避免的调用失败，比如超时、异常等，Hystrix能够保证在一个依赖出问题的情况下，不会导致整个服务失败，避免级联故障，以提高分布式系统的弹性。</p></li><li><p>Resilience4j：</p><p>Resilience4j是一款轻量级，易于使用的容错库，其灵感来自于Netflix Hystrix，但是专为Java 8和函数式编程而设计。轻量级，因为库只使用了Vavr，它没有任何其他外部依赖下。相比之下，Netflix Hystrix对Archaius具有编译依赖性，Archaius具有更多的外部库依赖性，例如Guava和Apache Commons Configuration。</p></li></ol><blockquote><p>https://pdai.tech/md/arch/arch-y-reduce.html</p><p>https://mp.weixin.qq.com/s?__biz=MzU0OTE4MzYzMw==&amp;mid=2247506440&amp;idx=4&amp;sn=5719c4fa0b9c80ed2ea0ab3c35d19a6b&amp;chksm=fbb153f6ccc6dae02cf5caae458cd245bde5ecf9ca3aa2905eab9a47cc4586064928ef82a314&amp;scene=27</p></blockquote></div><!--[--><!--]--></div><footer class="vp-page-meta"><!----><div class="vp-meta-item git-info"><div class="vp-meta-item last-updated"><span class="meta-item-label">Last Updated: </span><!----></div><div class="vp-meta-item contributors"><span class="meta-item-label">Contributors: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: lizhifuabc@163.com">拔土豆的程序员</span><!----><!--]--><!--]--></span></div></div></footer><!----><!--[--><!--]--></main><!--]--></div><!--[--><!----><!--]--><!--]--></div>
    <script type="module" src="/assets/app-oJgUVX7T.js" defer></script>
  </body>
</html>

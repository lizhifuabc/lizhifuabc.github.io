---
tags: [redis]
title: Redis的BigKey和HotKey
created: '2023-03-07T10:05:56.033Z'
modified: '2023-03-07T10:13:40.534Z'
---

# Redis的BigKey和HotKey

- BigKey：Key对应的value过大
- HotKey：热点Key

BigKey和HotKey都是在Redis中存储大量数据时可能会遇到的问题。为了避免这些问题的出现，需要使用合适的数据结构、合理地切分数据、合理地缓存热点数据等策略，从而保证Redis服务器的性能和稳定性。

## BigKey

在Redis中，一个键值对的大小不能超过512MB。如果一个键存储的值非常大，那么这个键就被称为BigKey。BigKey会导致Redis在进行持久化、备份、复制等操作时变得非常缓慢，甚至会导致Redis服务器崩溃。

1. 由于value值很大，序列化和反序列化时间过长，网络时延也长，从而导致操作Big Key的时候耗时很长，降低了Redis的性能。
2. 在集群模式下无法做到负载均衡，导致负载倾斜到某个实例上，单实例的QPS会比较高，内存占用比较多。
3. 由于Redis是单线程，如果要对这个大Key进行删除操作，被操作的实例可能会被block住，从而导致无法响应请求。

## BigKey处理

- 将大值切分为多个小值存储，这样可以避免出现单个键值对过大的情况。
- 使用Redis的Hash数据类型来存储大对象，将大对象切分为多个Hash键值对，这样可以减小单个键值对的大小。
- 可以考虑将大对象存储到Redis之外的存储系统中，如Hadoop等。

## HotKey

在Redis中，如果某个键被频繁地访问，那么这个键就被称为HotKey。HotKey会导致Redis在对这个键进行操作时变得非常缓慢，甚至会导致Redis服务器崩溃。原因是在Redis中，访问热点数据会导致CPU缓存失效，从而导致性能下降。


## HotKey处理

- 将热点数据缓存到内存中，避免频繁地访问Redis。
- 使用Redis的集群模式，将热点数据分散到不同的节点上，从而减小单个节点的负载。
- 使用Redis的一些高级特性，如分布式锁、Lua脚本等，避免频繁地访问同一个键。


